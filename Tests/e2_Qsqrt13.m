AttachSpec("../ModFrmHilD/spec");

printf "Testing E_2 over Q(sqrt(13)) and that E2^2 matches...";
// Create the graded ring
F:=QuadraticField(13);
ZF := Integers(F);
prec:=10;
M:=GradedRingOfHMFs(F, prec);
// Create the space of parallel weight [4,4] and level 1
ZF:=Integers(F);
N:=1*ZF;
M2 := HMFSpace(M, [2,2]);
X := HeckeCharacterGroup(N);
triv := X!1;
eta := X!1;
psi := X!1;

E2 := EisensteinSeries(M2, eta, psi);

assert [Coefficients(E2)[1*ZF][elt] : elt in ShintaniRepsUpToTrace(M, 1*ZF, 10)] eq
[ 1, 24, 96, 96, 120, 312, 480, 336, 480, 312, 384, 432, 576, 1248, 720, 720, 1248, 576, 432, 504, 960, 1560, 1056, 2016, 1728, 1680, 1728, 2016, 1056, 1560, 960, 624, 1344, 1728, 1488, 2304, 2496, 1920, 2904, 2904, 1920, 2496, 2304, 1488, 1728, 1344, 1920, 1296, 2160, 3840, 2880, 2448, 6240, 2736, 3600, 5376, 3600, 2736, 6240, 2448, 2880, 3840, 2160, 1296, 1200, 2304, 2880, 2496, 4368, 4224, 3360, 4800, 5616, 3792, 5184, 5184, 3792, 5616, 4800, 3360, 4224, 4368, 2496, 2880, 2304, 2040, 2880, 4800, 3072, 6552, 5184, 5280, 5952, 8160, 4800, 8640, 7488, 7056, 7488, 8640, 4800, 8160, 5952, 5280, 5184, 6552, 3072, 4800, 2880, 4056, 2592, 3168, 6912, 4176, 4608, 9216, 6048, 5616, 12480, 6048, 6192, 11520, 6336, 6336, 11520, 6192, 6048, 12480, 5616, 6048, 9216, 4608, 4176, 6912, 3168, 2592, 3120, 4224, 6720, 4368, 8640, 8112, 7440, 9360, 11520, 7368, 12480, 9984, 9600, 10368, 14520, 8736, 14520, 10368, 9600, 9984, 12480, 7368, 11520, 9360, 7440, 8112, 8640, 4368, 6720, 4224 ];


E2pow2 := E2^2;
assert [Coefficients(E2pow2)[1*ZF][elt] : elt in ShintaniRepsUpToTrace(M, 1*ZF, 10)] eq
[ 1, 48, 192, 192, 816, 5232, 14784, 20256, 14784, 5232, 6528, 38880, 107136, 176448, 196128, 196128, 176448, 107136, 38880, 33840, 171264, 399984, 654144, 964800, 1140480, 1196832, 1140480, 964800, 654144, 399984, 171264, 136032, 507264, 1140480, 1893408, 2813184, 3614208, 4047360, 4593072, 4593072, 4047360, 3614208, 2813184, 1893408, 1140480, 507264, 422016, 1215648, 2630880, 4734336, 6590592, 8542368, 11409216, 11944800, 13080096, 14263296, 13080096, 11944800, 11409216, 8542368, 6590592, 4734336, 2630880, 1215648, 991968, 2813184, 5657472, 9050496, 13716384, 18427776, 22129728, 27244032, 30831840, 32101152, 34515072, 34515072, 32101152, 30831840, 27244032, 22129728, 18427776, 13716384, 9050496, 5657472, 2813184, 2181936, 5657472, 11010048, 17035008, 26083440, 34515072, 42742848, 52582272, 61731264, 65298048, 74027520, 76063104, 75659040, 76063104, 74027520, 65298048, 61731264, 52582272, 42742848, 34515072, 26083440, 17035008, 11010048, 5657472, 4769328, 10113984, 18546624, 31881600, 42787872, 57715200, 78955776, 89294400, 104828256, 127998336, 131150016, 140248800, 158243328, 150581376, 150581376, 158243328, 140248800, 131150016, 127998336, 104828256, 89294400, 78955776, 57715200, 42787872, 31881600, 18546624, 10113984, 8452704, 18427776, 33091968, 49025184, 74027520, 97719648, 122205216, 152947872, 183230208, 199685136, 235312896, 253204224, 264990720, 283896576, 297054384, 284591424, 297054384, 283896576, 264990720, 253204224, 235312896, 199685136, 183230208, 152947872, 122205216, 97719648, 74027520, 49025184, 33091968, 18427776 ];

assert E2pow2/E2 eq E2;


printf "Success!\n";
exit;
